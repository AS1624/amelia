<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add outfit</title>
    <link rel="stylesheet" href="header.css">
    <link rel="stylesheet" href="body.css">
    <link rel="stylesheet" href="add.css">
</head>
<body>
    <header>
        <div id="top">
            <span id="search-container">add new outfit</span>
        </div>
    </header>
    <div id="content">
        <div id="text-input" >
            <label for="name">Name<br /></label>
            <input type="text" id="name" placeholder="outfit name">
            <br />
            <br />
            <label for="description">Description<br /></label>
            <input type="text" id="description" placeholder="outfit description">
            <br />
            <br />
            <label for="tags">Tags<br /></label>
            <input type="text" id="tags" placeholder="tags">
            <br />
            <br />
        </div>
        <label id="image-input-label" for="image-input">Add Image</label>
        <input type="file" id="image-input" accept="image/*">
        <button id="upload-button">Upload</button>
        <p id="status"></p>
        <br />
        <br />
        <div id="image-preview-container">
            <img id="uploaded-image" alt="">
        </div>
        <p id="response"></p>

        <script>
            let uploadButton = document.getElementById("upload-button");
            function updateShownImage() {
                let input = document.getElementById("image-input");
                let image = document.getElementById("uploaded-image");
                if(input.files.length > 0){
                    image.src = window.URL.createObjectURL(
                        input.files[0]
                    );
                    document.getElementById("image-preview-container").innerHTML += (
                        "<button id=\"remove\"> X </button>"
                    )
                    document.getElementById("remove").addEventListener("click", () => {
                        //remove image input's files, leave the input itself
                        input.value = ""
                        document.getElementById("remove").remove();
                        updateShownImage()
                    })
                }
                else {
                    image.src = ""
                }
            }

            if(document.getElementById("image-input").files.length > 0){
                updateShownImage();
            }
            document.getElementById("image-input").addEventListener("change", () => {
                console.log("image changed");
                updateShownImage();
            });
            document.getElementById("text-input").addEventListener("input", function(event) {
                console.log("upload status changed");
                console.log(document.getElementById("image-input").files[0])
                if (document.getElementById("name").value === ""
                    || document.getElementById("description").value === ""
                    || document.getElementById("tags").value === ""
                    || document.getElementById("image-input").files.length === 0
                ) {
                    uploadButton.style.background = "gray";
                } else {
                    uploadButton.style.background = "hotpink";
                }
            })

        </script>
        <script src="upload.js"></script>
    </div>
</body>
</html>
