<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add outfit</title>
    <link rel="stylesheet" href="header.css">
    <link rel="stylesheet" href="body.css">
    <link rel="stylesheet" href="add.css">
</head>
<body>
    <header>
        <div id="top">
            <span id="search-container">new outfit</span>
            <button id="upload-button" class="disabled">Upload</button>
        </div>
    </header>
    <div id="content">
        <div id="text-input-container" >
            <label for="name">Name<br /></label>
            <input type="text" id="name" class="form-input" placeholder="outfit name">
            <br />
            <br />
            <label for="description">Description<br /></label>
            <textarea
                    id="description"
                    class="form-input"
                    placeholder="clothes included: top, bottom, ect."
                    rows="4"
            >
            </textarea>
            <br />
            <br />
            <label for="tags">Tags<br /></label>
            <input type="text" id="tags" class="form-input" placeholder="tags">
            <br />
            <br />
        </div>
        <p id="status"></p>
        <br />
        <br />
        <div id="image-input-container">
            <label id="image-input-label" for="image-input">Add Image</label>
            <input type="file" id="image-input" accept="image/*">
        </div>
        <p id="response"></p>

        <script>
            showInput()
            document.getElementById("content").addEventListener("input", updateInputStatus)
            function showImage() {
                let input = document.getElementById("image-input");
                document.getElementById("image-input-container").innerHTML = (
                    "<img src=\""
                    + window.URL.createObjectURL(
                        input.files[0]
                    )
                    + "\" id=\"image-display\">"
                    + "\n <button id=\"remove\"> X </button>"
                );
                document.getElementById("remove").addEventListener("click", () => {
                    showInput()
                    updateInputStatus()
                })
            }
            function showInput() {
                document.getElementById("image-input-container").innerHTML = (
                    `<label id="image-input-label" for="image-input">Add Image</label>`
                    + `<input type="file" id="image-input" accept="image/*">`
                )
                document.getElementById("image-input").addEventListener("input", () => {
                    updateInputStatus()
                    showImage()
                })
            }
            function updateInputStatus(event) {
                let uploadButton = document.getElementById("upload-button");
                console.log("upload status changed");
                console.log(document.getElementById("image-input").files[0])
                if (document.getElementById("name").value === ""
                    || document.getElementById("description").value === ""
                    || document.getElementById("tags").value === ""
                    || document.getElementById("image-input").files.length === 0
                ) {
                    uploadButton.className = "disabled"
                } else {
                    uploadButton.className = "enabled"
                }
            }
        </script>
        <script src="upload.js"></script>
        <script>
            let button = document.getElementById('upload-button');
            button.addEventListener('click', async () => {
                if(button.className === "enabled") {
                    const imageInput = document.getElementById('image-input');
                    const file = imageInput.files[0];

                    if (!file) {
                        alert('Please select an image file to upload.');
                        return;
                    }

                    await uploadImageToGitHub(file);
                }
            });
        </script>
    </div>
</body>
</html>
